<div>
  <% if(estadoConsulta) { %> <!-- Tabla de un solo programa -->
    <table class="striped highlight responsive-table">
      <thead>
        <tr class="center strong">
          <% //var archivo = new Object(); %>
          <td rowspan="2">Participantes</td>
          <% //archivo.participante = 'Participante'; %>
          <% if(mostrarSexEdad) { %>
            <td class="center" rowspan="2">Sexo</td>
            <% //archivo.sexo = 'Sexo'; %>
            <td class="center" rowspan="2">Edad</td>
            <% //archivo.edad = 'Edad'; %>
          <% } %>

          <% if(mostrarCalif) { %>

            <% let cicloCont = 0, progCont = 0; %>
            <% for(let i = 0; i<cantCol; i++) { %>
              <td class="center" colspan="2"><%= datosGrupos[0].nombrePrograma %> Ciclo-<%= ciclos.ini+cicloCont %> </td>
              <% /*let calificacion_inicial = 'calificacion_inicial_' + ciclos.ini;
                 archivo[calificacion_inicial] = 'Calificacion Inicial ' + programas[listaProg[progCont]-1].nombrePrograma + ' Ciclo-' + ciclos.ini;*/ %>
              <% /*let calificacion_final = 'calificacion_final_' + cicloCont; 
                 let ciclo =  ciclos.ini+cicloCont;
                 archivo[calificacion_final] = 'Calificacion Final ' + programas[listaProg[progCont]-1].nombrePrograma + ' Ciclo-' + ciclos.ini;*/ %>
              
              <% if(((progCont+1) % cantProg) === 0){ %>
                <% progCont = 0; cicloCont++;%>
              <% } else { %>
                <%progCont++;%>
              <% } %>

            <% } %>

            <td class="center" rowspan="2">Calificación <br> Inicial <br> Absoluta </td>
            <% //archivo.calificacion_inicial = 'Calificación Inicial'; %>

            <td class="center" rowspan="2">Calificación <br> Final <br> Absoluta </td>
            <% //archivo.calificacion_final = 'Calificación Final'; %>

            <td class="center" rowspan="2">Promedio</td>
            <% //archivo.promedio = 'Promedio'; %>

            <td class="center" rowspan="2">Avance</td>
            <% //archivo.avance = 'Avance'; %>
          <% } %>
        </tr>
        <tr>
          <% if(mostrarCalif) { %>
            <% for(let i = 0; i<cantCol; i++) { %>
              <td class="center" > Calificación <br> Inicial</td>
              <td class="center"> Calificación <br> Final</td>
            <% } %>
          <% } %>
        </tr>
      </thead>
      <%//console.log(archivo) %>
      <% for(let i = 0; i < cantPart; i++) { %>
        <tr>

          <td><%= datos[i].nombreUsuario %> <%= datos[i].apellidoPaterno %> <%= datos[i].apellidoMaterno %></td>

          <% if(mostrarSexEdad) { %>
            <td class="center"><%= datos[i].sexo %></td>
            <td class="center"><%= datos[i].Edad %></td>
          <% } %>

          <% if(mostrarCalif) { %>

            <% let acumProm=0,contProm = 0,flagfin=0, flagIni=0, par=1;%>
            <% for(let j = 9; j<col_Datos.length; j++) { //9 porque es la primera calif Final %>

              <td class="center"><%= Math.round((datos[i][col_Datos[j]['name']] ) * 10) / 10 %> </td>

              <% if(datos[i][col_Datos[j]['name']] !== null && flagIni === 0){ %>
                <% flagIni = j; %>
              <% } %>

              <% if(datos[i][col_Datos[j]['name']] !== null && par % 2 === 0){ %>
                <% acumProm += Math.round((datos[i][col_Datos[j]['name']] ) * 10) / 10; %>
                <% contProm++; flagfin = j; %>
              <% } par++;%>

            <% } %>
            <td class="center"><%= Math.round((datos[i][col_Datos[flagIni]['name']] ) * 10) / 10 %></td>
            <td class="center"><%= Math.round((datos[i][col_Datos[flagfin]['name']] ) * 10) / 10 %></td>
            <td class="center"><%= Math.round((acumProm/contProm ) * 10) / 10 %></td>
            <td class="center"><%= Math.round(((datos[i][col_Datos[flagfin]['name']] - datos[i][col_Datos[flagIni]['name']])/(programas[listaProg[0]].puntajeMaximo-1)*100 ) * 10) / 10 %>%</td>
          <% } %>
        </tr>
      <% } %>
      <tbody>
        
      </tbody>
    </table>

  <% } else { %> <!-- Tabla de varios programas -->

    <table class="striped highlight responsive-table">
      <thead>
        <% if(!califOava) { %>
          <tr class="center strong">

            <td rowspan="2">Participantes</td>
  
            <% if(mostrarSexEdad) { %>
              <td class="center" rowspan="2">Sexo</td>
              <td class="center" rowspan="2">Edad</td>
            <% } %>
  
            <% if(mostrarCalif) { %>

              <% let cicloCont = 0, progCont = 0;%>
              <% for(let i = 0; i<cantCol; i++) { %>

                <td class="center" colspan="2"> <%= programas[listaProg[progCont]-1].nombrePrograma %> <br>Ciclo-<%= ciclos.ini+cicloCont %> </td>

                <% if(((progCont+1) % cantProg) === 0){%>
                  <% progCont = 0; cicloCont++;%>
                <% }else{ %>
                  <%progCont++; %>
                <% } %>

              <% } %>

            <% } %>
            
          </tr>
          <tr>
            <% if(mostrarCalif) { %>
              <% for(let i = 0; i<cantCol; i++) { %>
                <td class="center" > Calificación <br> Inicial</td>
                <td class="center"> Calificación <br> Final</td>
              <% } %>
            <% } %>
          </tr>
        <% } else { %>
          <tr class="center strong">

            <td>Participantes</td>
  
            <% if(mostrarSexEdad) { %>
              <td class="center">Sexo</td>
              <td class="center">Edad</td>
            <% } %>
  
            <% if(mostrarCalif) { %>

              <% let cicloCont = 0, progCont = 0;%>
              <% for(let i = 0; i<cantCol; i++) { %>

                <td class="center">Avance <br> <%= programas[listaProg[progCont]-1].nombrePrograma %> <br>Ciclo-<%= ciclos.ini+cicloCont %> </td>
            
                <% if(((progCont+1) % cantProg) === 0){%>
                  <% progCont = 0; cicloCont++;%>
                <% }else{ %>
                  <%progCont++; %>
                <% } %>

              <% } %>

            <% } %>
          </tr>
        <% } %>
        
      </thead>
      <tbody>
        <% for(let i = 0; i < cantPart; i++) { %>
          <tr>
            <td><%= datos[i].nombreUsuario %> <%= datos[i].apellidoPaterno %> <%= datos[i].apellidoMaterno %></td>
            <% if(mostrarSexEdad) { %>
              <td class="center"><%= datos[i].sexo %></td>
              <td class="center"><%= datos[i].Edad %></td>
            <% } %>
            <% if(mostrarCalif) { %>
              <% for(let j = 9; j < col_Datos.length; j++) { %>
                <% if(!califOava) { %>
                  <td class="center"><%= Math.round((datos[i][col_Datos[j]['name']] ) * 10) / 10 %></td>
                <% }else{ %>
                  <td class="center"><%= Math.round((datos[i][col_Datos[j]['name']] ) * 100) / 100 %> %</td>
                <% } %>
              <% } %>
            <% } %>
          </tr>
        <% } %>
      </tbody>
    </table> 
<% } %>                
</div>